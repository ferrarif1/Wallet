{"ast":null,"code":"var _jsxFileName = \"/Users/zhangyuanyi/Downloads/Wallet/rn-eth-demo/src/Metamask.js\";\nimport React, { Component } from 'react';\nimport { ethers } from \"ethers\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass Metamask extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n  async connectToMetamask() {\n    const provider = new ethers.providers.Web3Provider(window.ethereum);\n    const accounts = await provider.send(\"eth_requestAccounts\", []);\n    const balance = await provider.getBalance(accounts[0]);\n    const balanceInEther = ethers.utils.formatEther(balance);\n    const block = await provider.getBlockNumber();\n    provider.on(\"block\", block => {\n      this.setState({\n        block\n      });\n    });\n    this.setState({\n      selectedAddress: accounts[0],\n      balance: balanceInEther,\n      block\n    });\n  }\n  renderMetamask() {\n    if (!this.state.selectedAddress) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => this.connectToMetamask(),\n        children: \"Connect to Metamask\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 9\n      }, this);\n    } else {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Welcome \", this.state.selectedAddress]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Your ETH Balance is: \", this.state.balance]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Current ETH Block is: \", this.state.block]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 9\n      }, this);\n    }\n  }\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: this.renderMetamask()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }, this);\n  }\n}\nexport default Metamask;","map":{"version":3,"names":["React","Component","ethers","Metamask","constructor","props","state","connectToMetamask","provider","providers","Web3Provider","window","ethereum","accounts","send","balance","getBalance","balanceInEther","utils","formatEther","block","getBlockNumber","on","setState","selectedAddress","renderMetamask","render"],"sources":["/Users/zhangyuanyi/Downloads/Wallet/rn-eth-demo/src/Metamask.js"],"sourcesContent":["import React, { Component } from 'react';\n\nimport { ethers } from \"ethers\";\n\nclass Metamask extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n    };\n  }\n\n  async connectToMetamask() {\n    const provider = new ethers.providers.Web3Provider(window.ethereum)\n    const accounts = await provider.send(\"eth_requestAccounts\", []);\n    const balance = await provider.getBalance(accounts[0]);\n    const balanceInEther = ethers.utils.formatEther(balance);\n    const block = await provider.getBlockNumber();\n\n    provider.on(\"block\", (block) => {\n      this.setState({ block })\n    })\n\n    this.setState({ selectedAddress: accounts[0], balance: balanceInEther, block })\n  }\n\n  renderMetamask() {\n    if (!this.state.selectedAddress) {\n      return (\n        <button onClick={() => this.connectToMetamask()}>Connect to Metamask</button>\n      )\n    } else {\n      return (\n        <div>\n          <p>Welcome {this.state.selectedAddress}</p>\n          <p>Your ETH Balance is: {this.state.balance}</p>\n          <p>Current ETH Block is: {this.state.block}</p>\n        </div>\n      );\n    }\n  }\n\n  render() {\n    return(\n      <div>\n        {this.renderMetamask()}\n      </div>\n    )\n  }\n}\n\nexport default Metamask;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AAExC,SAASC,MAAM,QAAQ,QAAQ;AAAC;AAEhC,MAAMC,QAAQ,SAASF,SAAS,CAAC;EAC/BG,WAAW,CAACC,KAAK,EAAE;IACjB,KAAK,CAACA,KAAK,CAAC;IAEZ,IAAI,CAACC,KAAK,GAAG,CACb,CAAC;EACH;EAEA,MAAMC,iBAAiB,GAAG;IACxB,MAAMC,QAAQ,GAAG,IAAIN,MAAM,CAACO,SAAS,CAACC,YAAY,CAACC,MAAM,CAACC,QAAQ,CAAC;IACnE,MAAMC,QAAQ,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,qBAAqB,EAAE,EAAE,CAAC;IAC/D,MAAMC,OAAO,GAAG,MAAMP,QAAQ,CAACQ,UAAU,CAACH,QAAQ,CAAC,CAAC,CAAC,CAAC;IACtD,MAAMI,cAAc,GAAGf,MAAM,CAACgB,KAAK,CAACC,WAAW,CAACJ,OAAO,CAAC;IACxD,MAAMK,KAAK,GAAG,MAAMZ,QAAQ,CAACa,cAAc,EAAE;IAE7Cb,QAAQ,CAACc,EAAE,CAAC,OAAO,EAAGF,KAAK,IAAK;MAC9B,IAAI,CAACG,QAAQ,CAAC;QAAEH;MAAM,CAAC,CAAC;IAC1B,CAAC,CAAC;IAEF,IAAI,CAACG,QAAQ,CAAC;MAAEC,eAAe,EAAEX,QAAQ,CAAC,CAAC,CAAC;MAAEE,OAAO,EAAEE,cAAc;MAAEG;IAAM,CAAC,CAAC;EACjF;EAEAK,cAAc,GAAG;IACf,IAAI,CAAC,IAAI,CAACnB,KAAK,CAACkB,eAAe,EAAE;MAC/B,oBACE;QAAQ,OAAO,EAAE,MAAM,IAAI,CAACjB,iBAAiB,EAAG;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAA6B;IAEjF,CAAC,MAAM;MACL,oBACE;QAAA,wBACE;UAAA,uBAAY,IAAI,CAACD,KAAK,CAACkB,eAAe;QAAA;UAAA;UAAA;UAAA;QAAA,QAAK,eAC3C;UAAA,oCAAyB,IAAI,CAAClB,KAAK,CAACS,OAAO;QAAA;UAAA;UAAA;UAAA;QAAA,QAAK,eAChD;UAAA,qCAA0B,IAAI,CAACT,KAAK,CAACc,KAAK;QAAA;UAAA;UAAA;UAAA;QAAA,QAAK;MAAA;QAAA;QAAA;QAAA;MAAA,QAC3C;IAEV;EACF;EAEAM,MAAM,GAAG;IACP,oBACE;MAAA,UACG,IAAI,CAACD,cAAc;IAAE;MAAA;MAAA;MAAA;IAAA,QAClB;EAEV;AACF;AAEA,eAAetB,QAAQ"},"metadata":{},"sourceType":"module"}